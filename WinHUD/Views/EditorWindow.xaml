<Window x:Class="WinHUD.Views.EditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:nodes="clr-namespace:WinHUD.Models.Nodes"
        Title="WinHUD Layout Editor" Height="600" Width="900"
        WindowStartupLocation="CenterScreen"
        Background="#1E1E1E">

	<Grid>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="250"/>
			<ColumnDefinition Width="*"/>
		</Grid.ColumnDefinitions>

		<Border Grid.Column="0" Background="#252526" BorderBrush="#3F3F46" BorderThickness="0,0,1,0" Padding="15">
			<StackPanel>
				<TextBlock Text="Available Blocks" FontSize="16" FontWeight="Bold" Margin="0,0,0,15" Foreground="#E0E0E0"/>

				<ItemsControl ItemsSource="{Binding AvailableWidgets}">
					<ItemsControl.ItemTemplate>
						<DataTemplate>
							<Button Content="{Binding}"
									PreviewMouseDown="OnPreviewMouseDown"
                                    PreviewMouseMove="PaletteButton_MouseMove"
                                    Tag="{Binding}"
                                    Margin="0,0,0,8" Padding="10"
                                    Background="#333337" BorderBrush="#454545" Foreground="#FFFFFF"
                                    Cursor="Hand"/>
						</DataTemplate>
					</ItemsControl.ItemTemplate>
				</ItemsControl>

				<Button Content="ðŸ”„ Toggle Orientation"
                        Click="ToggleOrientation_Click"
                        Margin="0,20,0,0" Padding="10"
                        Background="#4CAF50" Foreground="White" FontWeight="Bold" BorderThickness="0"
                        Cursor="Hand"/>

				<Button Content="ðŸ’¾ Save &amp; Apply Layout"
                        Click="SaveButton_Click"
                        Margin="0,15,0,0" Padding="12"
                        Background="#007ACC" Foreground="White" FontWeight="Bold" BorderThickness="0"
                        Cursor="Hand"/>
			</StackPanel>
		</Border>

		<Border Grid.Column="1" Padding="20">
			<StackPanel VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
				<TextBlock Text="Active Layout (Grab â£¿ to reorder, edit text to rename prefix)" FontSize="16" FontWeight="Bold" Margin="0,0,0,15" Foreground="#E0E0E0"/>

				<Border Background="#2D2D30" BorderBrush="#3F3F46" BorderThickness="1"
                        Height="450" HorizontalAlignment="Stretch"
                        AllowDrop="True" Drop="ActiveLayout_Drop" ClipToBounds="True">

					<ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
						<ItemsControl ItemsSource="{Binding MainLayout.Children}">

							<ItemsControl.ItemsPanel>
								<ItemsPanelTemplate>
									<StackPanel Margin="10">
										<StackPanel.Style>
											<Style TargetType="StackPanel">
												<Setter Property="Orientation" Value="Vertical"/>
												<Style.Triggers>
													<DataTrigger Binding="{Binding MainLayout.Direction}" Value="Horizontal">
														<Setter Property="Orientation" Value="Horizontal"/>
													</DataTrigger>
												</Style.Triggers>
											</Style>
										</StackPanel.Style>
									</StackPanel>
								</ItemsPanelTemplate>
							</ItemsControl.ItemsPanel>

							<ItemsControl.ItemTemplate>
								<DataTemplate DataType="{x:Type nodes:WidgetNode}">
									<Border Background="#1E1E1E" BorderBrush="#3F3F46" BorderThickness="1"
                                            CornerRadius="4" Padding="5" Margin="5"
                                            MinWidth="{Binding MinWidth}" Height="35"
                                            PreviewMouseDown="OnPreviewMouseDown"
                                            AllowDrop="True" Drop="ActiveBlock_Drop" MouseMove="ActiveBlock_MouseMove">

										<Grid>
											<Grid.ColumnDefinitions>
												<ColumnDefinition Width="Auto"/>
												<ColumnDefinition Width="*"/>
												<ColumnDefinition Width="Auto"/>
											</Grid.ColumnDefinitions>

											<TextBlock Grid.Column="0" Text="â£¿" Foreground="#888" Margin="0,0,8,0"
                                                       Cursor="SizeAll" VerticalAlignment="Center" Background="Transparent"
                                                       Padding="5,0"/>

											<TextBox Grid.Column="1" Text="{Binding PrefixText, UpdateSourceTrigger=PropertyChanged}"
                                                     Foreground="#4CAF50" FontWeight="Bold" Background="Transparent"
                                                     BorderThickness="0" VerticalAlignment="Center" CaretBrush="White" MinWidth="30"/>

											<Button Grid.Column="2" Content="âŒ"
                                                    Click="RemoveWidget_Click"
                                                    Tag="{Binding}"
                                                    Background="Transparent" BorderThickness="0" Foreground="#F44336"
                                                    Cursor="Hand" Padding="5,0"/>
										</Grid>
									</Border>
								</DataTemplate>
							</ItemsControl.ItemTemplate>
						</ItemsControl>
					</ScrollViewer>
				</Border>
			</StackPanel>
		</Border>
	</Grid>
</Window>
